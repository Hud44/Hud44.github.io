<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Hudson" />


<title>Case Study 01</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Joshua Hudson Data Science Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About Me</a>
</li>
<li>
  <a href="Joshua_Hudson_Case_Study_01_Code.html">Case Study 01</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Case Study 01</h1>
<h4 class="author">Hudson</h4>
<h4 class="date">2/17/2022</h4>

</div>


<pre class="r"><code>#read in the datasets
library(readr)
beer = read_csv(&quot;C:\\Users\\Hudson\\OneDrive\\Documents\\Josh - Masters\\Doing Data Science - MSDS_6306\\Case Study 1\\Beers.csv&quot;)</code></pre>
<pre><code>## Rows: 2410 Columns: 7</code></pre>
<pre><code>## -- Column specification -------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (2): Name, Style
## dbl (5): Beer_ID, ABV, IBU, Brewery_id, Ounces</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>brew = read_csv(&quot;C:\\Users\\Hudson\\OneDrive\\Documents\\Josh - Masters\\Doing Data Science - MSDS_6306\\Case Study 1\\Breweries.csv&quot;)</code></pre>
<pre><code>## Rows: 558 Columns: 4</code></pre>
<pre><code>## -- Column specification -------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (3): Name, City, State
## dbl (1): Brew_ID</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>ab_brew = read_csv(&quot;C:\\Users\\Hudson\\OneDrive\\Documents\\Josh - Masters\\Doing Data Science - MSDS_6306\\Case Study 1\\AB_Breweries.csv&quot;)</code></pre>
<pre><code>## Rows: 13 Columns: 6</code></pre>
<pre><code>## -- Column specification -------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (4): Brewery, abb, City, State
## dbl (2): Brew_ID, Opening Date</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>ab_beer = read_csv(&quot;C:\\Users\\Hudson\\OneDrive\\Documents\\Josh - Masters\\Doing Data Science - MSDS_6306\\Case Study 1\\AB_Beers1.csv&quot;)</code></pre>
<pre><code>## New names:
## * `` -&gt; ...5
## * `` -&gt; ...6
## * `` -&gt; ...7
## * `` -&gt; ...8</code></pre>
<pre><code>## Rows: 27 Columns: 8</code></pre>
<pre><code>## -- Column specification -------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (3): Beer Name, Style, ABV
## dbl (1): IBU
## lgl (4): ...5, ...6, ...7, ...8</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>consume = read_csv(&quot;C:\\Users\\Hudson\\OneDrive\\Documents\\Josh - Masters\\Doing Data Science - MSDS_6306\\Case Study 1\\Beer_Consumption_By_State.csv&quot;)</code></pre>
<pre><code>## New names:
## * `` -&gt; ...6</code></pre>
<pre><code>## Rows: 51 Columns: 6</code></pre>
<pre><code>## -- Column specification -------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (2): State, abb
## dbl (2): Rank, Gallons_Per_Capita
## lgl (1): ...6</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>#load the needed libraries
library(ggplot2)
library(GGally)
library(magrittr)
library(dplyr)
library(tidyverse)
library(usmap)
library(maps)
library(mapproj)
library(fiftystater)
library(&quot;car&quot;)
library(class)
library(caret)
library(e1071)
library(tidyverse)
library(ggExtra)</code></pre>
<p>Analysis Questions: 1.How many breweries are present in each state?</p>
<pre class="r"><code>#1.How many breweries are present in each state?
st_count = brew %&gt;% group_by(State) %&gt;% summarize(Count =n_distinct(Brew_ID))
st_count</code></pre>
<pre><code>## # A tibble: 51 x 2
##    State Count
##    &lt;chr&gt; &lt;int&gt;
##  1 AK        7
##  2 AL        3
##  3 AR        2
##  4 AZ       11
##  5 CA       39
##  6 CO       47
##  7 CT        8
##  8 DC        1
##  9 DE        2
## 10 FL       15
## # ... with 41 more rows</code></pre>
<pre class="r"><code>write_excel_csv(st_count, file = &quot;num_brew &quot; )
colnames(st_count)[1] = &quot;abb&quot; #rename state to abb for future merge
lookup = data.frame(abb = state.abb, State = state.name) #load in state names and state abbreviations to a dataframe for future merge
st_count = merge(st_count,lookup,&quot;abb&quot;) #make a single data set with state names and abbreviations
st_count$region &lt;- tolower(st_count$State) #make all state names lowercase for future merge
st_count = st_count[-1]
#states = map_data(&quot;state&quot;)
colnames(fifty_states)[6] = &quot;region&quot;
st_count = merge(fifty_states, st_count, by = &quot;region&quot;, all.x = T) #merge the dateframes to include regions
st_count = st_count[order(st_count$order),] #order the dataframe to paint a proper map

st_count %&gt;% ggplot(aes(x = fifty_states$long, y = fifty_states$lat, group = group)) + geom_polygon(aes(fill = Count)) + geom_path() + scale_fill_gradientn(colors = hcl.colors(10, &quot;RdYlGn&quot;, rev = TRUE), na.value = &quot;grey90&quot;)+ggtitle(&quot;Number of Breweries in Each State&quot;) + xlab(&quot;Latitude&quot;) + ylab(&quot;Longitude&quot;) + coord_quickmap()#plot the heatmap</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-3-1.png" width="672" /> Answer: Simply run the code and review “st_count” tibble for answer to Question 1</p>
<p>Supplemental question Which states consume the most beer?</p>
<pre class="r"><code># #the following Beer consumption data was found on the following article: https://vinepair.com/articles/map-states-drink-beer-america-2020/#:~:text=THE%20STATES%20THAT%20DRINK%20THE%20MOST%20BEER%20OVERALL,and%20New%20York%20trailing%20behind.%20Ranking%20The%20States
con_count = consume %&gt;% group_by(abb) %&gt;% summarize(Gallons = Gallons_Overall)  
write_excel_csv(con_count, file = &quot;consume&quot; )
#colnames(con_count)[1] = &quot;abb&quot; #rename state to abb for future merge
lookup = data.frame(abb = state.abb, State = state.name) #load in state names and state abbreviations to a dataframe for future merge Count
con_count = merge(con_count,lookup,&quot;abb&quot;) #make a single data set with state names and abbreviations
con_count$region &lt;- tolower(con_count$State) #make all state names lowercase for future merge
con_count = con_count[-1]
#states = map_data(&quot;state&quot;)
colnames(fifty_states)[6] = &quot;region&quot;
con_count = merge(fifty_states, con_count, by = &quot;region&quot;, all.x = T) #merge the dateframes to include regions
con_count = con_count[order(con_count$order),] #order the dataframe to paint a proper map

con_count %&gt;% ggplot(aes(x = fifty_states$long, y = fifty_states$lat, group = group)) + geom_polygon(aes(fill = Gallons)) + geom_path() +  scale_fill_gradientn(colors = hcl.colors(10, &quot;RdYlGn&quot;, rev = TRUE), na.value = &quot;grey90&quot;) + ggtitle(&quot;2018 Beer Consumption per State&quot;) + xlab(&quot;Latitude&quot;) + ylab(&quot;Longitude&quot;) + coord_quickmap()#plot the heatmap</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-4-1.png" width="672" /> 2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file. (RMD only, this does not need to be included in the presentation or the deck.)</p>
<pre class="r"><code>colnames(beer)[5] = &quot;Brew_ID&quot;  #rename brewery ID in Beers data to match Breweries data&#39;s brewery ID for future merge
colnames(beer)[1] = &quot;Beer Name&quot; #delineates between beer name and brewery names
colnames(brew)[2] = &quot;Brewery Name&quot;

bb = merge(beer, brew, by = &quot;Brew_ID&quot;, all.x = T) #make the merge
head(bb) #1st six observations</code></pre>
<pre><code>##   Brew_ID     Beer Name Beer_ID   ABV IBU                               Style
## 1       1  Get Together    2692 0.045  50                        American IPA
## 2       1 Maggie&#39;s Leap    2691 0.049  26                  Milk / Sweet Stout
## 3       1    Wall&#39;s End    2690 0.048  19                   English Brown Ale
## 4       1       Pumpion    2689 0.060  38                         Pumpkin Ale
## 5       1    Stronghold    2688 0.060  25                     American Porter
## 6       1   Parapet ESB    2687 0.056  47 Extra Special / Strong Bitter (ESB)
##   Ounces      Brewery Name        City State
## 1     16 NorthGate Brewing Minneapolis    MN
## 2     16 NorthGate Brewing Minneapolis    MN
## 3     16 NorthGate Brewing Minneapolis    MN
## 4     16 NorthGate Brewing Minneapolis    MN
## 5     16 NorthGate Brewing Minneapolis    MN
## 6     16 NorthGate Brewing Minneapolis    MN</code></pre>
<pre class="r"><code>tail(bb) #last six observations</code></pre>
<pre><code>##      Brew_ID                 Beer Name Beer_ID   ABV IBU
## 2405     556             Pilsner Ukiah      98 0.055  NA
## 2406     557  Heinnieweisse Weissebier      52 0.049  NA
## 2407     557           Snapperhead IPA      51 0.068  NA
## 2408     557         Moo Thunder Stout      50 0.049  NA
## 2409     557         Porkslap Pale Ale      49 0.043  NA
## 2410     558 Urban Wilderness Pale Ale      30 0.049  NA
##                        Style Ounces                  Brewery Name
## 2405         German Pilsener     12         Ukiah Brewing Company
## 2406              Hefeweizen     12       Butternuts Beer and Ale
## 2407            American IPA     12       Butternuts Beer and Ale
## 2408      Milk / Sweet Stout     12       Butternuts Beer and Ale
## 2409 American Pale Ale (APA)     12       Butternuts Beer and Ale
## 2410        English Pale Ale     12 Sleeping Lady Brewing Company
##               City State
## 2405         Ukiah    CA
## 2406 Garrattsville    NY
## 2407 Garrattsville    NY
## 2408 Garrattsville    NY
## 2409 Garrattsville    NY
## 2410     Anchorage    AK</code></pre>
<p>Answer: Simply run the code and see data.frames “head(bb)” and “tail(bb)” for answer to Question 2.</p>
<ol start="3" style="list-style-type: decimal">
<li>Address the missing values in each column.</li>
</ol>
<pre class="r"><code>bb_clean = na.omit(bb) #%&gt;% filter(!is.na(ABV) &amp; !is.na(IBU) &amp; !is.na(Style))</code></pre>
<p>Answer: Simply run the code and see data.frame bb_clean for answer to question 3</p>
<ol start="4" style="list-style-type: decimal">
<li>Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.</li>
</ol>
<pre class="r"><code>#get the median values for each state
abv = bb_clean  %&gt;% group_by(State) %&gt;% summarise(median(ABV)) 
ibu = bb_clean  %&gt;% group_by(State) %&gt;% summarise(median(IBU))

#make a data frame from the median values
meds = merge(abv, ibu, by = &quot;State&quot;) 
print(meds)</code></pre>
<pre><code>##    State median(ABV) median(IBU)
## 1     AK      0.0570        46.0
## 2     AL      0.0600        43.0
## 3     AR      0.0400        39.0
## 4     AZ      0.0550        20.0
## 5     CA      0.0580        42.0
## 6     CO      0.0650        40.0
## 7     CT      0.0610        29.0
## 8     DC      0.0590        47.5
## 9     DE      0.0550        52.0
## 10    FL      0.0620        55.0
## 11    GA      0.0620        55.0
## 12    HI      0.0520        22.5
## 13    IA      0.0560        26.0
## 14    ID      0.0580        39.0
## 15    IL      0.0570        30.0
## 16    IN      0.0570        33.0
## 17    KS      0.0500        20.0
## 18    KY      0.0575        31.5
## 19    LA      0.0510        31.5
## 20    MA      0.0540        35.0
## 21    MD      0.0565        29.0
## 22    ME      0.0670        61.0
## 23    MI      0.0560        35.0
## 24    MN      0.0555        44.5
## 25    MO      0.0500        24.0
## 26    MS      0.0580        45.0
## 27    MT      0.0570        40.0
## 28    NC      0.0610        33.5
## 29    ND      0.0500        32.0
## 30    NE      0.0560        35.0
## 31    NH      0.0465        48.5
## 32    NJ      0.0460        34.5
## 33    NM      0.0610        51.0
## 34    NV      0.0550        41.0
## 35    NY      0.0595        47.0
## 36    OH      0.0575        40.0
## 37    OK      0.0630        35.0
## 38    OR      0.0560        40.0
## 39    PA      0.0570        30.0
## 40    RI      0.0525        24.0
## 41    SC      0.0500        30.0
## 42    TN      0.0550        37.0
## 43    TX      0.0550        34.0
## 44    UT      0.0400        34.0
## 45    VA      0.0570        42.0
## 46    VT      0.0550        30.0
## 47    WA      0.0560        38.0
## 48    WI      0.0510        19.0
## 49    WV      0.0620        57.5
## 50    WY      0.0510        21.0</code></pre>
<pre class="r"><code>#order the states by median values
am = meds[order(meds$`median(ABV)`),]
im = meds[order(meds$`median(IBU)`),]





#Barplot for median ABV for each state
am %&gt;% ggplot(aes(x = reorder(State, -`median(ABV)`), y = `median(ABV)`, fill = `median(ABV)`)) + geom_col() + ggtitle(&quot;Median ABV for Each State&quot;) + xlab(&quot;State&quot;) + ylab(&quot;Median ABV&quot;) + labs(fill = &quot;Median ABV&quot;)</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>#ready US map plot for ABV for each state
colnames(am)[1] = &quot;abb&quot;
am  = merge(am ,lookup,&quot;abb&quot;) #make a single data set with state names and abbreviations
am $region &lt;- tolower(am $State) #make all state names lowercase for future merge
am  = am [-1]
colnames(fifty_states)[6] = &quot;region&quot;
am = merge(fifty_states, am, by = &quot;region&quot;, all.x = T) #merge the dateframes to include regions
am = am[order(am$order),] #order the dataframe to paint a proper map

#heatmap for the median ABV for each state
am %&gt;% ggplot(aes(x = fifty_states$long, y = fifty_states$lat, group = group)) + geom_polygon(aes(fill = `median(ABV)`)) + geom_path() + scale_fill_gradientn(colors = hcl.colors(10, &quot;RdYlGn&quot;, rev = TRUE), na.value = &quot;grey90&quot;)+ggtitle(&quot;Median ABV for Each State&quot;) + xlab(&quot;Latitude&quot;) + ylab(&quot;Longitude&quot;) + coord_quickmap()</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<pre class="r"><code>#Barplot for median IBU for each state
im %&gt;% ggplot(aes(x = reorder(State, -`median(IBU)`), y = `median(IBU)`, fill = `median(IBU)`)) + geom_col() + ggtitle(&quot;Median IBU for Each State&quot;) + xlab(&quot;State&quot;) + ylab(&quot;Median IBU&quot;) + labs(fill = &quot;Median IBU&quot;)</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-7-3.png" width="672" /></p>
<pre class="r"><code>#ready US map plot for median IBU for each state
colnames(im)[1] = &quot;abb&quot;
im  = merge(im ,lookup,&quot;abb&quot;) #make a single data set with state names and abbreviations
im $region &lt;- tolower(im $State) #make all state names lowercase for future merge
im  = im [-1]
colnames(fifty_states)[6] = &quot;region&quot;
im = merge(fifty_states, im, by = &quot;region&quot;, all.x = T) #merge the dateframes to include regions
im = im[order(im$order),] #order the dataframe to paint a proper map

#heatmap for the median IBU for each state
im %&gt;% ggplot(aes(x = fifty_states$long, y = fifty_states$lat, group = group)) + geom_polygon(aes(fill = `median(IBU)`)) + geom_path() + scale_fill_gradientn(colors = hcl.colors(10, &quot;RdYlGn&quot;, rev = TRUE), na.value = &quot;grey90&quot;)+ggtitle(&quot;Median IBU for Each State&quot;) + xlab(&quot;Latitude&quot;) + ylab(&quot;Longitude&quot;) + coord_quickmap()</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-7-4.png" width="672" /> Answer: Simply run the code and review the bar graphs and heat maps for answers to question 4.</p>
<ol start="5" style="list-style-type: decimal">
<li>Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?</li>
</ol>
<pre class="r"><code>#order the states by median values
abv_max = bb_clean  %&gt;% group_by(State) %&gt;% summarise(max(ABV)) 
abv_max = abv_max[order(-abv_max$`max(ABV)`),]
abv_max[1,]</code></pre>
<pre><code>## # A tibble: 1 x 2
##   State `max(ABV)`
##   &lt;chr&gt;      &lt;dbl&gt;
## 1 KY         0.125</code></pre>
<pre class="r"><code>ibu_max = bb_clean  %&gt;% group_by(State) %&gt;% summarise(max(IBU))
ibu_max = ibu_max[order(-ibu_max$`max(IBU)`),]
ibu_max[1,]</code></pre>
<pre><code>## # A tibble: 1 x 2
##   State `max(IBU)`
##   &lt;chr&gt;      &lt;dbl&gt;
## 1 OR           138</code></pre>
<p>Answer: Kentucky has the maximum ABV beer. Oregon has the maximum IBU beer.</p>
<ol start="6" style="list-style-type: decimal">
<li>Comment on the summary statistics and distribution of the ABV variable.</li>
</ol>
<pre class="r"><code>summary(bb_clean$ABV)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.02700 0.05000 0.05700 0.05992 0.06800 0.12500</code></pre>
<pre class="r"><code>bb_clean %&gt;% ggplot(mapping = aes(x = ABV,  fill = &quot;red&quot; )) + geom_histogram() + ggtitle(&quot;ABV Value Distribution&quot;) + xlab(&quot;ABV Value&quot;) + ylab(&quot;Count of ABV Value&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>shapiro.test(bb_clean$ABV)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  bb_clean$ABV
## W = 0.93663, p-value &lt; 2.2e-16</code></pre>
<pre class="r"><code>qqPlot(bb_clean$ABV)</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre><code>## [1]  8 57</code></pre>
<p>Answer: The ABV values does not closely follow a normal distribution. In fact, it is slightly skewed right with a mean of 0.060 and median of 0.057. This implies that there are other variables that are influencing the ABV values for beers across the country. This information begs to be further analyzed to find relationships that ABV values could have with other variables.</p>
<ol start="7" style="list-style-type: decimal">
<li>Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot. Make your best judgment of a relationship and EXPLAIN your answer.</li>
</ol>
<pre class="r"><code>#assign categories for 
abv_cat = bb_clean %&gt;% mutate(ABV_Category = cut(ABV, breaks = c(0,0.5000,0.05700, 0.06800, 0.12600), labels = c(&quot;Low&quot;,&quot;Medium&quot;, &quot;High&quot;, &quot;Very High&quot;)))

#summary(bb_clean$IBU)
abv_ibu_cat = abv_cat %&gt;% mutate(IBU_Category = cut(IBU, breaks = c(0,21,35, 64, 139), labels = c(&quot;Low&quot;,&quot;Medium&quot;, &quot;High&quot;, &quot;Very High&quot;)))

p = abv_ibu_cat %&gt;% ggplot(mapping = aes(x = IBU, y = ABV)) + geom_point(position = &quot;jitter&quot;, color = &quot;red&quot;) + geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;blue&quot;) + ggtitle(&quot;International Bitterness Unit (IBU) vs Alcohol by Volume (ABV)&quot;) + xlim(0,150) + ylim(0,0.130)

ggMarginal(p, type=&quot;histogram&quot;, fill = &quot;red&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>#test relationships between the IBU and ABV variables
relate_test &lt;-  cor.test(abv_ibu_cat$IBU, abv_ibu_cat$ABV, method = &quot;spearman&quot;)</code></pre>
<pre><code>## Warning in cor.test.default(abv_ibu_cat$IBU, abv_ibu_cat$ABV, method =
## &quot;spearman&quot;): Cannot compute exact p-value with ties</code></pre>
<pre class="r"><code>##########################################################
###Because the p-value of the test is 2.2e-16, which is less than the significance level alpha = 0.05. We can conclude that IBU and ABV are significantly correlated with a correlation coefficient of 0.6707224 and p-value of 2.2e-16.
##########################################################
#abv_ibu_cat %&gt;% select(IBU, ABV, ABV_Category, IBU_Category) %&gt;% ggpairs(aes(color = IBU_Category))</code></pre>
<p>Answer: Because the p-value of the test is 2.2e-16, which is less than the significance level alpha = 0.05. We can conclude that IBU and ABV are significantly correlated with a correlation coefficient of 0.6707224 and p-value of 2.2e-16.</p>
<ol start="8" style="list-style-type: decimal">
<li>Budweiser would also like to investigate the difference with respect to IBU and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with “Ale” in its name other than IPA). You decide to use KNN classification to investigate this relationship. Provide statistical evidence one way or the other. You can of course assume your audience is comfortable with percentages … KNN is very easy to understand conceptually.</li>
</ol>
<p>In addition, while you have decided to use KNN to investigate this relationship (KNN is required) you may also feel free to supplement your response to this question with any other methods or techniques you have learned. Creativity and alternative solutions are always encouraged.</p>
<pre class="r"><code>bb_clean = na.omit(bb)#reset bb_clean
IPAorALE = &quot;&quot;

#populate IPAorALE column 
for(i in 1:length(bb_clean$Style)){
if(grepl(&quot;IPA&quot;, bb_clean$Style[i], fixed = TRUE) == &quot;TRUE&quot;){
  bb_clean$IPAorALE[i] = &quot;IPA&quot;} else if(grepl(&quot;Ale&quot;, bb_clean$Style[i], fixed = TRUE) == &quot;TRUE&quot;){
    bb_clean$IPAorALE[i] = &quot;Ale&quot;} else {
      bb_clean$IPAorALE[i] = &quot;Other&quot;}
}
bb_clean = bb_clean %&gt;% relocate(IPAorALE, .after = Style) #relocate the style classification next to Style


IvA = bb_clean %&gt;% filter(IPAorALE != &quot;Other&quot;) #build a dataframe for just IPAs and Ales only 
abv_ttest = t.test(ABV ~ IPAorALE, IvA)#run ttest to show differences in ABV means between IPAs and Ales
abv_ttest</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  ABV by IPAorALE
## t = -16.23, df = 794.65, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means between group Ale and group IPA is not equal to 0
## 95 percent confidence interval:
##  -0.01410901 -0.01106438
## sample estimates:
## mean in group Ale mean in group IPA 
##        0.05655616        0.06914286</code></pre>
<pre class="r"><code>IBU_ttest = t.test(IBU ~ IPAorALE, IvA)#run ttest to show differences in IBU means between IPAs and Ales
IBU_ttest</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  IBU by IPAorALE
## t = -30.118, df = 797.55, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means between group Ale and group IPA is not equal to 0
## 95 percent confidence interval:
##  -40.06727 -35.16402
## sample estimates:
## mean in group Ale mean in group IPA 
##          34.33333          71.94898</code></pre>
<pre class="r"><code>#plot the non-Anheuser-Busch beers IBU v ABV and delineate the beer style (IPA or Ale)
bb_clean %&gt;% ggplot(mapping = aes(x = IBU, y = ABV, color = IPAorALE)) + geom_point(position = &quot;jitter&quot;) + geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;blue&quot;) + ggtitle(&quot;International Bitterness Unit (IBU) vs Alcohol by Volume (ABV)&quot;) +scale_color_discrete(&quot;Style of Beer&quot;) + xlim(0,150) + ylim(0,0.130)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>#plot the Anheuser-Busch beers IBU v ABV and delineate the beer style (IPA or Ale)
ab_beer = na.omit(ab_beer)
ab_beer %&gt;% ggplot(mapping = aes(x = IBU, y = ABV, color = Style)) + geom_point(position = &quot;jitter&quot;) + ggtitle(&quot;International Bitterness Unit (IBU) vs Alcohol by Volume (ABV)&quot;) +scale_color_discrete(&quot;Style of Beer&quot;) + xlim(0,150) + ylim(0,0.130)</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<pre class="r"><code>#set up knn
set.seed(6) #set the seed
splitperc = .70 #training the model with 70% of the data and testing the models accuracy with 30% of the data

#setting up the knn training data
train_i = sample(1:length(bb_clean$IPAorALE), round(splitperc*length(bb_clean$IPAorALE)))
train = bb_clean[train_i, ]
test = bb_clean[-train_i, ]

class = knn(train[, c(4,5)], test[, c(4,5)], train$IPAorALE, prob = TRUE, k = 5)
table(class, test$IPAorALE)</code></pre>
<pre><code>##        
## class   Ale IPA Other
##   Ale    93  20    59
##   IPA    14  95     5
##   Other  45   7    83</code></pre>
<pre class="r"><code>confusionMatrix(table(class, test$IPAorALE))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##        
## class   Ale IPA Other
##   Ale    93  20    59
##   IPA    14  95     5
##   Other  45   7    83
## 
## Overall Statistics
##                                           
##                Accuracy : 0.6437          
##                  95% CI : (0.5959, 0.6895)
##     No Information Rate : 0.361           
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.4618          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.3509          
## 
## Statistics by Class:
## 
##                      Class: Ale Class: IPA Class: Other
## Sensitivity              0.6118     0.7787       0.5646
## Specificity              0.7063     0.9365       0.8102
## Pos Pred Value           0.5407     0.8333       0.6148
## Neg Pred Value           0.7631     0.9121       0.7762
## Prevalence               0.3610     0.2898       0.3492
## Detection Rate           0.2209     0.2257       0.1971
## Detection Prevalence     0.4086     0.2708       0.3207
## Balanced Accuracy        0.6591     0.8576       0.6874</code></pre>
<pre class="r"><code>#head(meds)
demand = &quot;&quot;
model = data.frame(meds, demand)
#head(model)

#use best knn k-value to classify each state to predict the style of beer that could be in highest demand based on ABV and IBU
for(i in 1:length(meds$State))
{
  try =  knn(train[,c(4,5)], meds[i, c(2,3)], train$IPAorALE, prob = TRUE, k = 5)
  model[i , 4] = try[1]
  if(model[i , 4] == &quot;1&quot;){
    model[i , 5] = &quot;Ale&quot;} else if(model[i , 4] == &quot;2&quot;){
      model[i , 5] = &quot;IPA&quot;} else if(model[i , 4] == &quot;3&quot;){
        model[i , 5] = &quot;Other&quot;}
}

#This model predicts what style of beer each state most demands.
Style_Demand = as.numeric(model$demand)
model = data.frame(model, Style_Demand)</code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Knock their socks off! Find one other useful inference from the data that you feel Budweiser may be able to find value in. You must convince them why it is important and back up your conviction with appropriate statistical evidence.</li>
</ol>
<pre class="r"><code>abb = model$State
model = data.frame(model, abb)
predict_count = model %&gt;% group_by(abb) %&gt;% summarize(Demand = Style_Demand)  
write_excel_csv(predict_count, file = &quot;model&quot; )
#colnames(predict_count)[1] = &quot;abb&quot; #rename state to abb for future merge
lookup = data.frame(abb = state.abb, State = state.name) #load in state names and state abbreviations to a dataframe for future merge Count
predict_count = merge(predict_count,lookup,&quot;abb&quot;) #make a single data set with state names and abbreviations
predict_count$region &lt;- tolower(predict_count$State) #make all state names lowercase for future merge
predict_count = predict_count[-1]
#states = map_data(&quot;state&quot;)
colnames(fifty_states)[6] = &quot;region&quot;
predict_count = merge(fifty_states, predict_count, by = &quot;region&quot;, all.x = T) #merge the dateframes to include regions
predict_count = predict_count[order(predict_count$order),] #order the dataframe to paint a proper map
#cols = c(&quot;Ale&quot; = &quot;red&quot;, &quot;IPA&quot; = &quot;blue&quot;, &quot;Other&quot; = &quot;darkgreen&quot;)

predict_count %&gt;% ggplot(aes(x = fifty_states$long, y = fifty_states$lat, group = group)) + geom_polygon(aes(fill = Demand)) + geom_path() + scale_fill_gradientn(colors = c( &quot;indianred1&quot;,&quot;limegreen&quot;, &quot;cornflowerblue&quot;), na.value = &quot;grey90&quot;)+ggtitle(&quot;In-Demand Style&quot;) + xlab(&quot;Latitude&quot;) + ylab(&quot;Longitude&quot;) + coord_quickmap()</code></pre>
<p><img src="Joshua_Hudson_Case_Study_01_Code_files/figure-html/unnamed-chunk-12-1.png" width="672" /> Answer: Using machine learning model, (KNN), we can predict which style of beer is in most demand for each state. Couple this with the consumption rate data, there could be opportunity to capitalize on understanding both sets of demand.</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
